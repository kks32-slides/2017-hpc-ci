<!doctype html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <title>Journey towards HPC and CI</title>

    <link rel="stylesheet" href="css/reveal.css">
    <link rel="stylesheet" href="css/theme/white.css">

    <!-- Theme used for syntax highlighting of code -->
    <link rel="stylesheet" href="lib/css/zenburn.css">

    <!-- Printing and PDF exports -->
    <script>
        var link = document.createElement('link');
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = window.location.search.match(/print-pdf/gi) ? 'css/print/pdf.css' : 'css/print/paper.css';
        document.getElementsByTagName('head')[0].appendChild(link);
    </script>

    <!-- MathJax -->
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
    </script>

    <!-- Script for Video play back on Slide for multiple videos-->
    <script
      src = "js/video.js">
    </script>

</head>

<body>
    <div class="reveal">
        <div class="slides">
            <!-- Section -->
            <section>
              <section>
                <h2>Our journey towards CI and HPC</h2>
                <h3>TravisCI, CircleCI, Jenkins and containers</h3>
                <p>
                  <br/>Jeffrey Salmond <a href="mailto:js947@cam.ac.uk">js947@cam.ac.uk</a>,
                  <br/>Krishna Kumar <a href="mailto:kks32@cam.ac.uk">kks32@cam.ac.uk</a>,
                  <br/>University of Cambridge
                </p>
                <br/>
                <div style="float: left; width: 100%;">
                  <span style="float: left; width: 33%; text-align: center;">
                    <img style="border:0;" src="images/themes/cued.png" width="100%">
                    <img style="border:0;" src="images/cam-rcs.png" width="100%">
                  </span>
                  <span style="float: left; width: 33%; text-align: center;">
                    <img style="border:0;" src="images/themes/cb-geo-text-white.png" width="100%">
                  </span>
                  <span style="float: right; width: 33%; text-align: center;">
                    <img style="border:0;" src="images/themes/hpcs.png" width="100%">
                  </span>
                </div>
                <br/><br/>
                <h4>Imperial College London<br/>10 November 2017.</h4>
              </section>
            </section>

            <section>
              <section>
                <h3>Overview</h3>
                <ul>
                  <li>Who we are</li>
                  <li>Why CI and what do we want to acheive</li>
                  <li>How (Test frameworks, Travis, Jenkins)</li>
                  <li>How - Containers (Docker, Singularity)</li>
                </ul>
              </section>
            </section>

            <section><!-- Who we are -->
              <section>
                <h3>Cambridge-Berkeley computational geomechanics</h3>
                <ul>
                  <li> Lattice-Boltzmann + Discrete Element Method </li>
                  <li> Finite Element Method - Thermo-Hydro Mechanical Coupling</li>
                  <li> Material Point Method </li>
                  <li> Lattice Element Method </li>
                </ul>
                <figure>
                  <img src="images/themes/cb-geo.png" width ="100%">
                  <figcaption><a href="http://www.cb-geo.com">View the CB-Geo website for 
                      more information and software tools</a></figcaption>
                </figure>
              </section>

              <section>
                <h3>Research Computing @Cambridge</h3>
                <ul>
                  <li>Cambridge Service for Data-Driven Discovery (CSD3)
                    <ul>
                      <li><strong>Wilkes-2</strong> <br/>
                        360 NVidia P100 GPUs</li>
                      <li><strong>PETA4</strong><br/>
                        24576 cores Intel Skylake + <br/>
                        342 nodes Intel Xeon Phi (Knights Landing)</li>
                      <li><strong>Openstack</strong> private cloud infrastructure</li></ul>
                  </li>
                </ul>
                <figure>
                  <img src="images/csd3.png" height="200">
                  <img src="images/wilkes2.png" height="200">
                  <img src="images/peta4.png" height="200">
                </figure>
              </section>

              <section>
                <h3>Research Software Engineering @Cambridge</h3>
                <ul>
                  <li>Partner with researchers at Cambridge and other Universities</li>
                  <li>Help researchers make better use of our compute resources</li>
                  <li>Spread information about best practices<br/>
                        "software carpentry" "reproducible research"</li>
                </ul>
                <figure>
                  <img src="images/bettersoftware.jpg" height="200">
                </figure>
              </section>
            </section>

            <!-- Software development -->
            <section>

              <!-- Git -->
              <section>
                <h2>Git hosting</h2>
                <img src="images/git-hosting.jpg" width="80%">
                <p style="color:#239b56">GitLab has integrated CI!</p>
                <p>Repositories are auto-mirrored between GitHub and GitLab</p>
                <p style="color:#FF0000">Issues / PRs are not synced after first mirror</p>
              </section>


              
              <!-- Continous Integration -->
              <section>
                <h2>What do we want to test with Continous Integration?</h2>
                <div style="float: left; width: 50%;">
                  <ul>
                    <li>Builds: Multiple compilers and optimisations</li>
                    <li>Unit testing</li>
                    <li>Benchmarks</li>
                    <li>Static analysis</li>
                    <li>Coverage analysis</li>
                    <li>Formatting - clangformat</li>
                    <li>Documentation</li>
                    <li>Continous delivery - Deployments</li>
                  </ul>
                </div>
                <div style="float: right; width: 50%;">
                  <img src="images/gitlab_ci.png" width="80%">
                </div>                              
                <img src="images/ci.png" width="80%">
              </section>

              <!-- Unit testing -->
              <section>
                <h2>Unit testing</h2>
                <div style="float: left; width: 40%;">
                  <ul>
                    <li>Test every function</li>
                    <li>Test for all possible values</li>
                    <li>C++ unit testing frameworks: </li>
                     <ul>
                       <li>Catch</li>
                       <li>Google mock test</li>
                       <li>Boost unit test</li>
                     </ul>
                  </ul>
                  <p>
                    <span class="fragment highlight-green">
                      All tests passed (36 assertions in 3 test cases)
                    </span>
                  </p>
                  <img src="images/jenkins.png" width="80%">
                </div>
                <div style="float: right; width: 60%;">
                  <img src="images/unit_test.png" width="80%">
                </div>
              </section>

              
              <section>
                <h3>TravisCI: Build matrix for different compilers</h3>
                <div style="float: left; width: 100%;">
                  <span style="float: left; width: 50%; text-align: center;">
                    <img style="border:0;" src="images/build-matrix1.png" width="80%">
                  </span>
                  <span style="float: right; width: 50%; text-align: center;">
                    <img style="border:0;" src="images/build-matrix2.png" width="80%">
                  </span>
                </div>
                <p style="color:#239b56">Travis allows for Caching repos and directories</p>
                <p style="color:#FF0000">Installing multiple versions of libraries is complicated!</p>
              </section>

              <section>
                <h3>Challenges of running CI on HPC</h3>
                <ul>
                  <li>Job schedulers</li>
                </ul>
              </section>

              <!-- Containers -->
              <section>
                <h2>Docker containers</h2>
                <ul>
                  <li>Automates the deployment of applications by packaging an application with all of its dependencies into software containers.</li>
                  <li>Docker containers wrap up a piece of software in a complete filesystem that contains everything it needs to run: code, runtime, system tools, system libraries â€“ anything you can install on a server.</li>
                  <li>This guarantees that it will always run the same - <strong>Research reproducability</strong></li>
                  </ul>
                <img src="images/docker-vm.png" width="60%">
              </section>

              <section>
                <h3>Challenges of running Docker on HPC environments</h3>
                <ul>
                  <li>Permissions on multi-user unix</li>
                  <li>Permissions on shared file systems</li>
                </ul>
              </section>

              <section>
                <h3>Singularity containers</h3>
                <ul>
                  <li>Compatible with (many) docker images</li>
                  <li>Allows access to external filesystems</li>
                </ul>
                <img src="images/singularity.svg">
              </section>

              <!-- Software development roadmap -->
              <section>
                <h3>Future HPCS and Big-Data systems</h3>
                <div style="float: left; width: 45%;">
                  <ul>
                    <li>Opensource development</li>
                    <li>Modular code development</li>
                    <li>HDF5</li>
                    <li>In memory databases</li>
                    <li>Apache Spark - MapReduce</li>
                    <li>Version control</li>
                    <li>Unit testing</li>
                    <li>Continous integration and deployment</li>
                    <li>Docker container - Kubernetes</li>
                  </ul>
                </div>
                <div style="float: right; width: 55%;">
                    <img src="images/software.png" width ="100%">
                </div>
              </section>
            </section>

            <!-- Summary -->
            <section>
              <!-- Thank you! -->
              <section>
                <h1> Thank you!! </h1>
                <p>
                  <br/> Krishna Kumar, <a href="mailto:kks32@cam.ac.uk">kks32@cam.ac.uk</a>,
                  <br/>Jeffrey Salmond <a href="mailto:js947@cam.ac.uk">js947@cam.ac.uk</a>
                </p>
                <br/>
                <br/><br/>

                <div style="float: left; width: 100%;">
                  <span style="float: left; width: 33%; text-align: center;">
                    <img style="border:0;" src="images/themes/cued.png" width="100%">
                    <img style="border:0;" src="images/cam-rcs.png" width="100%">
                  </span>
                  <span style="float: left; width: 33%; text-align: center;">
                    <img style="border:0;" src="images/themes/cb-geo-text-white.png" width="100%">
                  </span>
                  <span style="float: right; width: 33%; text-align: center;">
                    <img style="border:0;" src="images/themes/hpcs.png" width="100%">
                  </span>
                </div>
              </section>
            </section>
            <!-- Special thanks to Chitra atthai! -->
        </div>
    </div>

    <script src="lib/js/head.min.js"></script>
    <script src="js/reveal.js"></script>

    <script>
        // More info https://github.com/hakimel/reveal.js#configuration
        Reveal.initialize({
            history: true,
            slideNumber: 'c/t',
            // More info https://github.com/hakimel/reveal.js#dependencies
            dependencies: [{
                src: 'plugin/markdown/marked.js'
            }, {
                src: 'plugin/markdown/markdown.js'
            }, {
                src: 'plugin/notes/notes.js',
                async: true
            }, {
                src: 'plugin/highlight/highlight.js',
                async: true,
                callback: function() {
                    hljs.initHighlightingOnLoad();
                }
            }]
        });
    </script>
</body>

</html>
